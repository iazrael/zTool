(function(e){var g={UNDEFINED:0,BUILDED:1,LOADED:2,INITED:3},k={},m={},a=function(b){if(k[b])return k[b];var b=b.split("."),d=window,a;for(a in b){if(!(b[a]in d))return e;d=d[b[a]]}return d},j=function(b){return(b=a(b))?b.packageStatus:g.UNDEFINED},i=function(l,d,c){"string"===typeof l&&(l=a(l));var f={},j=a("Z");if(d)for(var e in d)f[e]=a(d[e]);c&&c.call(l,j,f);l.packageStatus=g.INITED;l=l.packageName;if(d=m[l]){for(f=0;f<d.length;f++)c=d[f],b(c.requirePackages)&&i(c.packageName,c.requirePackages,
c.constructor);delete m[l]}},b=function(b){if(!b)return!0;var d,a;for(a in b)if(d=b[a],j(d)!==g.INITED)return!1;return!0},c=function(){var a,d,c;a=arguments[0];3===arguments.length?(d=arguments[1],c=arguments[2]):c=arguments[1];var f;f=k[a];if(!f){f=window;var j=a.split("."),e;for(e in j)j[e]in f||(f[j[e]]={}),f=f[j[e]];k[a]=f}if(!("packageName"in f))f.packageName=a;if(!("packageStatus"in f))f.packageStatus=g.BUILDED;if(f.packageStatus===g.BUILDED)f.packageStatus=g.LOADED;if(d&&!b(d))for(var n in d)f=
d[n],m[f]||(m[f]=[]),m[f].push({packageName:a,requirePackages:d,constructor:c});else i(f,d,c)};c("Z",function(b){b.PACKAGE_STATUS=g;b.$package=c;b.getPackage=a;b.getPackageStatus=j})})();
Z.$package("Z",function(e){this.debug=function(a){window.console&&(console.debug?console.debug(a):console.log(a))};var g=Object.prototype.toString;this.is=function(a,j){var i=g.call(j).slice(8,-1);return void 0!==j&&null!==j&&i===a};this.isString=function(a){return"[object String]"===g.call(a)};this.isArray=Array.isArray||function(a){return"[object Array]"===g.call(a)};this.isArguments=function(a){return"[object Arguments]"===g.call(a)};this.isObject=function(a){return"[object Object]"===g.call(a)};
this.isFunction=function(a){return"[object Function]"===g.call(a)};this.isUndefined=function(a){return"[object Undefined]"===g.call(a)};this.isEmpty=function(a){if(a){if(this.isArray(a))return!!a.length;for(var j in a)return!1;return!0}return!1};var k=function(a,j,i){for(var b=arguments,c,l=1;l<b.length;l++){c=b[l];for(var d in c)a[d]=e.isArray(c[d])?c[d].concat():e.isObject(c[d])?a[d]&&e.isArray(a[d])?k({},c[d]):k({},a[d],c[d]):c[d]}return a},m=function(a){if(e.isArray(a))return a.concat();if(e.isArguments(a)){for(var j=
[],i=0,b;b=a[i];i++)j.push(m(b));return j}if(e.isObject(a))return k({},a);throw Error("the argument isn't an object or array");};this.merge=k;this.duplicate=m;this.extend=function(a,j){k(a,j);a.prototype=k({},j.prototype,a.prototype)}});
Z.$package("Z",function(e){var g=function(){},k=function(a,i){1===arguments.length&&(i=a,a={});i=i||{};if(!e.isFunction(i.init))i.init=g;var b=function(){return this.init.apply(this,arguments)},c=a.extend;if(c){if("interface"===c.type&&e.isArray(c.methods)&&e.isFunction(c.checkImplements))throw Error("can not extend a interface!");var l=c.prototype.init,d=i.init,h=e.duplicate(c.prototype);delete h.init;var c=b.prototype=e.merge({},c.prototype,i),f;for(f in h)e.isFunction(h[f])&&e.isFunction(c[f])&&
(c[f]=function(b,a){return function(){var c=this.$super;this.$super=b;a.apply(this,arguments);this.$super=c}}(h[f],c[f]));b.prototype.init=function(){var a=e.duplicate(arguments);l.apply(this,a);this.$static=b;a=e.duplicate(arguments);d.apply(this,a)}}else d=i.init,b.prototype=i,b.prototype.init=function(){this.$static=b;d.apply(this,arguments)};b.prototype.constructor=b;b.type="class";b.className=a.name||"anonymous";if(h=a["implements"]){f=[];for(var k in h)c=h[k].checkImplements(b.prototype),f=
f.concat(c);if(f.length)throw Error("the '"+b.className+"' class hasn't implemented the interfaces's methods . ["+f+"]");}a.statics&&e.merge(b,a.statics);return b},m=function(a){var i=[],b,c;for(c in this.methods)b=a[this.methods[c]],(!b||!e.isFunction(b))&&i.push(methods[c]);return i},a=function(a,i){1===arguments.length&&(i=a,a={});var b=function(){throw Error("the interface can not be Instantiated!");};b.type="interface";b.interfaceName=a.name||"anonymous";b.methods=i;b.checkImplements=m;return b};
this.define=function(e,i,b){var c=Array.prototype.slice.call(arguments,1);if("class"===e)return k.apply(this,c);if("interface"===e)return a.apply(this,c)};this.$class=k;this.$interface=a});
Z.$package("Z.message",function(e){var g,k=0,m=function(){if(!g&&(g=document.createElement("div"),!document.createEvent))g.style.cssText="position: absolute; top: -9999em; left: -9999em; width: 0px; height: 0px;",document.body.appendChild(g);return g},a=function(a,b,c){var e,d,h,f;if(2>arguments.length)throw Error("addListener arguments not enough");2===arguments.length&&(c=b,b=a,a=window);if(!a.__listeners)a.__listeners={},a.__listenerId=+new Date+""+k++;h=a.__listeners;f=a.__listenerId;if(h[b])for(d in h[b]){if(e=
h[b][d],e.func===c)return!1}else h[b]=[];d=m();d.addEventListener?(e=function(a){c.apply(window,a.params)},d.addEventListener(f+"-"+b,e,!1)):(e=function(a){var a=window.event,d=a.params.pop();b===a.params[1]&&d===f&&c.apply(window,a.params)},d.attachEvent("onpropertychange",e));e={func:c,wrapFunc:e};h[b].push(e);return!0},j=function(a,b,c){var e,d,h,f;if(2>arguments.length)throw Error("removeListener arguments not enough");2===arguments.length&&(c=b,b=a,a=window);h=a.__listeners;f=a.__listenerId;
if(!h||!h[b])return!1;d=m();for(var g in h[b])if(e=h[b][g],e.func===c)return h[b].slice(g,1),d.removeEventListener?d.removeEventListener(f+"-"+b,e.wrapFunc,!1):d.detachEvent("onpropertychange",e.wrapFunc),!0;return!1};this.on=this.addListener=a;this.off=this.removeListener=j;this.notify=function(a,b,c){var g,d,h,f;1===arguments.length?(b=a,a=window):2===arguments.length&&e.isString(a)&&(c=b,b=a,a=window);e.debug("notify message: "+b);h=a.__listeners;f=a.__listenerId;if(!h||!h[b])return!1;g=m();document.createEvent?
(d=document.createEvent("Events"),d.initEvent(f+"-"+b,!1,!1),d.params=[c,b],g.dispatchEvent(d)):(d=document.createEventObject("onpropertychange"),d.params=[c,b,f],g.fireEvent("onpropertychange",d));return 0!==h[b].length}});
