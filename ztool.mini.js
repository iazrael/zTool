(function(e){var g={UNDEFINED:0,BUILDED:1,LOADED:2,INITED:3},l={},k={},a=0,i=function(b){if(l[b])return l[b];var b=b.split("."),c=window,h;for(h in b){if(!(b[h]in c))return e;c=c[b[h]]}return c},f=function(b){return(b=i(b))?b.packageStatus:g.UNDEFINED},c=function(b,a,f){"string"===typeof b&&(b=i(b));var d={},e=i("Z");if(a)for(var o in a)d[o]=i(a[o]);f&&f.call(b,e,d);b.packageStatus=g.INITED;b=b.packageName;if(a=k[b]){for(d=0;d<a.length;d++)f=a[d],h(f.requirePackages)&&c(f.packageName,f.requirePackages,
f.constructor);delete k[b]}},h=function(b){if(!b)return!0;var c,h;for(h in b)if(c=b[h],f(c)!==g.INITED)return!1;return!0},d=function(){var b,f,d;b=arguments[0];3===arguments.length?(f=arguments[1],d=arguments[2]):2===arguments.length?d=arguments[1]:(b="Z.anonymous."+a++,d=arguments[0]);var j;j=b;var e=l[j];if(!e){var e=window,i=j.split("."),n;for(n in i)i[n]in e||(e[i[n]]={}),e=e[i[n]];l[j]=e}if(!("packageName"in e))e.packageName=j;if(!("packageStatus"in e))e.packageStatus=g.BUILDED;j=e;if(j.packageStatus===
g.BUILDED)j.packageStatus=g.LOADED;if(f&&!h(f))for(var p in f)j=f[p],k[j]||(k[j]=[]),k[j].push({packageName:b,requirePackages:f,constructor:d});else c(j,f,d)};d("Z",function(b){b.PACKAGE_STATUS=g;b.$package=d;b.getPackage=i;b.getPackageStatus=f})})();
Z.$package("Z",function(e){this.debug=function(a){window.console&&(console.debug?console.debug(a):console.log(a))};var g=Object.prototype.toString;this.is=function(a,e){var f=g.call(e).slice(8,-1);return void 0!==e&&null!==e&&f===a};this.isString=function(a){return"[object String]"===g.call(a)};this.isArray=Array.isArray||function(a){return"[object Array]"===g.call(a)};this.isArguments=function(a){return"[object Arguments]"===g.call(a)};this.isObject=function(a){return"[object Object]"===g.call(a)};
this.isFunction=function(a){return"[object Function]"===g.call(a)};this.isUndefined=function(a){return"[object Undefined]"===g.call(a)};this.isEmpty=function(a){if(a){if(this.isArray(a))return!!a.length;for(var e in a)return!1;return!0}return!1};var l=function(a,g,f){for(var c=arguments,h,d=1;d<c.length;d++){h=c[d];for(var b in h)a[b]=e.isArray(h[b])?h[b].concat():e.isObject(h[b])?a[b]&&e.isArray(a[b])?l({},h[b]):l({},a[b],h[b]):h[b]}return a},k=function(a){if(e.isArray(a))return a.concat();if(e.isArguments(a)){for(var g=
[],f=0,c;c=a[f];f++)g.push(k(c));return g}if(e.isObject(a))return l({},a);throw Error("the argument isn't an object or array");};this.merge=l;this.duplicate=k;this.extend=function(a,e){l(a,e);a.prototype=l({},e.prototype,a.prototype);a.prototype.constructor=a}});
Z.$package("Z",function(e){var g=function(){},l=/this.\$super/,k=function(f,c){1===arguments.length&&(c=f,f={});c=c||{};if(!e.isFunction(c.init))c.init=g;var h=function(){return this.init.apply(this,arguments)},d=f.extend;if(d){if("interface"===d.type&&e.isArray(d.methods)&&e.isFunction(d.checkImplements))throw Error("can not extend a interface!");var b=d.prototype.init,a=c.init,m=e.duplicate(d.prototype);delete m.init;var d=h.prototype=e.merge({},d.prototype,c),j,k,i;for(i in m)j=d[i],k=m[i],e.isFunction(k)&&
e.isFunction(j)&&l.test(j)&&(d[i]=function(b,f){return function(){var c=this.$super;this.$super=b;f.apply(this,arguments);this.$super=c}}(k,j));h.prototype.init=function(){var f=e.duplicate(arguments);b.apply(this,f);this.$static=h;a.apply(this,arguments)}}else a=c.init,h.prototype=c,h.prototype.init=function(){this.$static=h;a.apply(this,arguments)};h.prototype.constructor=h;h.type="class";h.className=f.name||"anonymous";if(m=f["implements"]){i=[];for(var n in m)d=m[n].checkImplements(h.prototype),
i=i.concat(d);if(i.length)throw Error("the '"+h.className+"' class hasn't implemented the interfaces's methods . ["+i+"]");}f.statics&&e.merge(h,f.statics);return h},a=function(f){var c=[],a,d;for(d in this.methods)a=f[this.methods[d]],(!a||!e.isFunction(a))&&c.push(methods[d]);return c},i=function(f,c){1===arguments.length&&(c=f,f={});var h=function(){throw Error("the interface can not be Instantiated!");};h.type="interface";h.interfaceName=f.name||"anonymous";h.methods=c;h.checkImplements=a;return h};
this.define=function(f,c,a){var d=Array.prototype.slice.call(arguments,1);if("class"===f)return k.apply(this,d);if("interface"===f)return i.apply(this,d)};this.$class=k;this.$interface=i});
Z.$package("Z.message",function(e){var g,l=0,k=function(){if(!g&&(g=document.createElement("div"),!document.createEvent))g.style.cssText="position: absolute; top: -9999em; left: -9999em; width: 0px; height: 0px;",document.body.appendChild(g);return g},a=function(f,c,a){var d,b,e,g;if(2>arguments.length)throw Error("addListener arguments not enough");2===arguments.length&&(a=c,c=f,f=window);if(!f.__listeners)f.__listeners={},f.__listenerId=+new Date+""+l++;e=f.__listeners;g=f.__listenerId;if(e[c])for(b in e[c]){if(d=
e[c][b],d.func===a)return!1}else e[c]=[];b=k();b.addEventListener?(d=function(b){a.apply(window,b.params)},b.addEventListener(g+"-"+c,d,!1)):(d=function(b){var b=window.event,f=b.params.pop();c===b.params[1]&&f===g&&a.apply(window,b.params)},b.attachEvent("onpropertychange",d));d={func:a,wrapFunc:d};e[c].push(d);return!0},i=function(a,c,e){var d,b,g,i;if(2>arguments.length)throw Error("removeListener arguments not enough");2===arguments.length&&(e=c,c=a,a=window);g=a.__listeners;i=a.__listenerId;
if(!g||!g[c])return!1;b=k();for(var j in g[c])if(d=g[c][j],d.func===e)return g[c].slice(j,1),b.removeEventListener?b.removeEventListener(i+"-"+c,d.wrapFunc,!1):b.detachEvent("onpropertychange",d.wrapFunc),!0;return!1};this.on=this.addListener=a;this.off=this.removeListener=i;this.notify=function(a,c,h){var d,b,g,i;1===arguments.length?(c=a,a=window):2===arguments.length&&e.isString(a)&&(h=c,c=a,a=window);e.debug("notify message: "+c);g=a.__listeners;i=a.__listenerId;if(!g||!g[c])return!1;d=k();document.createEvent?
(b=document.createEvent("Events"),b.initEvent(i+"-"+c,!1,!1),b.params=[h,c],d.dispatchEvent(b)):(b=document.createEventObject("onpropertychange"),b.params=[h,c,i],d.fireEvent("onpropertychange",b));return 0!==g[c].length}});
