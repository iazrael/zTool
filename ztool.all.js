(function(c){var b={UNDEFINED:0,BUILDED:1,LOADED:2,INITED:3},a={},d={},e=0,f=function(b){if(a[b])return a[b];var b=b.split("."),d=window,e;for(e in b){if(!(b[e]in d))return c;d=d[b[e]]}return d},g=function(a){return(a=f(a))?a.packageStatus:b.UNDEFINED},i=function(a,e,c){"string"===typeof a&&(a=f(a));var g={},h=f("Z");if(e)for(var n in e)g[n]=f(e[n]);c&&c.call(a,h,g);a.packageStatus=b.INITED;a=a.packageName;if(e=d[a]){for(g=0;g<e.length;g++)c=e[g],k(c.requirePackages)&&i(c.packageName,c.requirePackages,
c.constructor);delete d[a]}},k=function(a){if(!a)return!0;var d,e;for(e in a)if(d=a[e],g(d)!==b.INITED)return!1;return!0},h=function(){var f,c,g;f=arguments[0];3===arguments.length?(c=arguments[1],g=arguments[2]):2===arguments.length?g=arguments[1]:(f="Z.anonymous."+e++,g=arguments[0]);var h;h=f;var o=a[h];if(!o){var o=window,n=h.split("."),q;for(q in n)n[q]in o||(o[n[q]]={}),o=o[n[q]];a[h]=o}if(!("packageName"in o))o.packageName=h;if(!("packageStatus"in o))o.packageStatus=b.BUILDED;h=o;if(h.packageStatus===
b.BUILDED)h.packageStatus=b.LOADED;if(c&&!k(c))for(var r in c)h=c[r],d[h]||(d[h]=[]),d[h].push({packageName:f,requirePackages:c,constructor:g});else i(h,c,g)};h("Z",function(a){a.PACKAGE_STATUS=b;a.$package=h;a.getPackage=f;a.getPackageStatus=g})})();
Z.$package("Z.array",function(){this.remove=function(c,b,a){var d=!1;if(2===arguments.length){var e=c.indexOf(b);-1!==e&&(c.splice(e,1),d=!0)}else for(var e=0,f=c.length;e<f;e++)if(c[e][b]===a){c.splice(e,1);d=!0;break}return d};this.filter=function(c,b,a){var d=[],e;for(e in c)c[e][b]===a&&d.push(c[e]);return d};this.contains=function(c,b){return-1<c.indexOf(b)};this.uniquelize=function(c){for(var b=[],a=0,d=c.length;a<d;a++)this.contains(b,c[a])||b.push(c[a]);return b};this.parse=function(c){return Array.prototype.slice.call(c)}});
Z.$package("Z",function(c){this.debug=function(b){window.console&&(console.debug?console.debug(b):console.log(b))};var b=Object.prototype.toString;this.is=function(a,d){var e=b.call(d).slice(8,-1);return void 0!==d&&null!==d&&e===a};this.isString=function(a){return"[object String]"===b.call(a)};this.isArray=Array.isArray||function(a){return"[object Array]"===b.call(a)};this.isArguments=function(a){return"[object Arguments]"===b.call(a)};this.isObject=function(a){return"[object Object]"===b.call(a)};
this.isFunction=function(a){return"[object Function]"===b.call(a)};this.isUndefined=function(a){return"[object Undefined]"===b.call(a)};this.isEmpty=function(a){if(a){if(this.isArray(a))return!!a.length;for(var b in a)return!1;return!0}return!1};var a=this.isSameObject=function(b,d,e){if(b===d||!b&&!d)return!0;for(var k in b)if(b.hasOwnProperty(k))if(c.isObject(b[k])&&c.isObject(d[k])&&e){if(!a(b[k],d[k],e))return!1}else if(b[k]!==d[k])return!1;return!0},d=function(a,b,e){for(var k=arguments,h,l=
1;l<k.length;l++){h=k[l];for(var j in h)a[j]=c.isArray(h[j])?h[j].concat():c.isObject(h[j])?a[j]&&c.isArray(a[j])?d({},h[j]):d({},a[j],h[j]):h[j]}return a},e=function(a){if(c.isArray(a))return a.concat();if(c.isArguments(a)){for(var b=[],i=0,k;k=a[i];i++)b.push(e(k));return b}if(c.isObject(a))return d({},a);throw Error("the argument isn't an object or array");};this.merge=d;this.duplicate=e;this.extend=function(a,b){d(a,b);a.prototype=d({},b.prototype,a.prototype);a.prototype.constructor=a}});
Z.$package("Z.browser",function(c){var b=this;(function(){var a={set:function(a,b){this.name=a;this.version=b;this[a]=b}},d,c=navigator.userAgent.toLowerCase();(d=c.match(/msie ([\d.]+)/))?a.set("ie",d[1]):(d=c.match(/firefox\/([\d.]+)/))?a.set("firefox",d[1]):(d=c.match(/chrome\/([\d.]+)/))?a.set("chrome",d[1]):(d=c.match(/opera.([\d.]+)/))?a.set("opera",d[1]):(d=c.match(/version\/([\d.]+).*safari/))&&a.set("safari",d[1]);Z.merge(b,a)})();var a={ie:"Ms",firefox:"Moz",opera:"O",chrome:"Webkit",safari:"Webkit"},
d;this.cssSupport=function(b,f,g){var i;d||(d=document.createElement("div"));i=d;if(b in i.style)return i.style[b]=f,i.style[b]===f;return g?(g=b.charAt(0).toUpperCase(),b=a[c.browser.name]+g+b.substr(1),cssSupport(b,!1,f)):!1}});
Z.$package("Z",function(c){var b=function(){},a=/this.\$super/,d=function(d,e){1===arguments.length&&(e=d,d={});e=e||{};if(!c.isFunction(e.init))e.init=b;var f=function(){return this.init.apply(this,arguments)},h=d.extend;if(h){if("interface"===h.type&&c.isArray(h.methods)&&c.isFunction(h.checkImplements))throw Error("can not extend a interface!");var l=h.prototype.init,j=e.init,m=c.duplicate(h.prototype);delete m.init;var h=f.prototype=c.merge({},h.prototype,e),p,o,n;for(n in m)p=h[n],o=m[n],c.isFunction(o)&&
c.isFunction(p)&&a.test(p)&&(h[n]=function(a,b){return function(){var d=this.$super;this.$super=a;b.apply(this,arguments);this.$super=d}}(o,p));f.prototype.init=function(){var a=c.duplicate(arguments);l.apply(this,a);this.$static=f;j.apply(this,arguments)}}else j=e.init,f.prototype=e,f.prototype.init=function(){this.$static=f;j.apply(this,arguments)};f.prototype.constructor=f;f.type="class";f.className=d.name||"anonymous";if(m=d["implements"]){n=[];for(var q in m)h=m[q].checkImplements(f.prototype),
n=n.concat(h);if(n.length)throw Error("the '"+f.className+"' class hasn't implemented the interfaces's methods . ["+n+"]");}d.statics&&c.merge(f,d.statics);return f},e=function(a){var b=[],d,e;for(e in this.methods)d=a[this.methods[e]],(!d||!c.isFunction(d))&&b.push(methods[e]);return b},f=function(a,b){1===arguments.length&&(b=a,a={});var d=function(){throw Error("the interface can not be Instantiated!");};d.type="interface";d.interfaceName=a.name||"anonymous";d.methods=b;d.checkImplements=e;return d};
this.define=function(a,b,e){var c=Array.prototype.slice.call(arguments,1);if("class"===a)return d.apply(this,c);if("interface"===a)return f.apply(this,c)};this.$class=d;this.$interface=f});
Z.$package("Z.cookie",function(c){var b=window.location.host;this.set=function(a,d,e,f,g){if(g){var i=new Date;i.setTime(+new Date+36E5*g)}c.isString(d)||(d=JSON.stringify(d));d=window.encodeURIComponent(d);window.document.cookie=a+"="+d+"; "+(g?"expires="+i.toGMTString()+"; ":"")+(f?"path="+f+"; ":"path=/; ")+(e?"domain="+e+";":"domain="+b+";")};this.get=function(a){a=window.document.cookie.match(RegExp("(?:^|;+|\\s+)"+a+"=([^;]*)"));a=!a?"":a[1];a=window.decodeURIComponent(a);try{a=JSON.parse(a)}catch(b){}return a};
this.remove=function(a,d,e){window.document.cookie=a+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; "+(e?"path="+e+"; ":"path=/; ")+(d?"domain="+d+";":"domain="+b+";")}});
Z.$package("Z.date",function(){this.format=function(c,b){var a={"M+":c.getMonth()+1,"d+":c.getDate(),"h+":c.getHours(),"m+":c.getMinutes(),"s+":c.getSeconds(),"q+":Math.floor((c.getMonth()+3)/3),S:c.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(c.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in a)RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?a[d]:("00"+a[d]).substr((""+a[d]).length)));return b}});
Z.$package("Z.dom",function(){this.ellipsis=function(c,b){var a=c.clientWidth,b=b||"â€¦",d=c.cloneNode(!0);d.id="checkTextLengthNode";d.style.cssText="position: absolute;left: -99999em;width: auto !important;";c.parentNode.appendChild(d);if(!(d.clientWidth<=a)){d.innerHTML=b;for(var e=d.clientWidth,f=c.innerHTML,f=f.replace(/\s+/g," "),g,i=0,k=0,h=f.length;k<h;k++)if(g=f.charAt(k),d.innerHTML=" "===g?"&nbsp;":g,i+=d.clientWidth,i+e>a){f=f.substr(0,k);break}c.innerHTML=f+b;d.parentNode.removeChild(d)}}});
Z.$package("Z.dom",["Z.string"],function(c){var b=this;this.get=function(a){return document.getElementById(a)};this.query=function(a,b){var b=b||document,c=a.charAt(0),g=a.substring(1);return"#"===c?this.get(g):"."===c?b.querySelectorAll(a):b.getElementsByTagName(a)};var a={};this.getTemplate=function(b){var e=a[b];if(!e){var c=this.get(b),e=c.innerHTML;c.parentNode.removeChild(c);a[b]=e}if(!e)throw Error('no such template. [id="'+b+'"]');return e};this.getActionTarget=function(a,b,c,g){for(var a=
a.target,i=b||3,b=-1!==b,c=c||"cmd",g=g||document.body;a&&a!==g&&(b?0<i--:1);){if(a.getAttribute(c))return a;a=a.parentNode}return null};this.render=function(a,b,f,g){f=f||{};b=this.getTemplate(b);b=c.string.template(b,f);"string"===typeof a&&(a=this.get(a));if(!c.isUndefined(g)&&a.childElementCount){f=document.createElement("div");f.innerHTML=b;for(var b=f.childNodes,i=document.createDocumentFragment();b[0];)i.appendChild(b[0]);-1===g||g>=a.childElementCount-1?a.appendChild(i):a.insertBefore(i,a.children[g]);
delete f}else a.innerHTML=b};this.bindCommends=function(a,e,f){1===arguments.length?(f=a,a=document.body,e="click"):2===arguments.length&&(f=e,e="click");a.__commends?c.merge(a.__commends,f):(a.__commends=f,a.addEventListener(e,function(a){var d=b.getActionTarget(a,3,"cmd",this);if(d){var e=d.getAttribute("cmd"),c=d.getAttribute("param");d.href&&0===d.getAttribute("href").indexOf("#")&&a.preventDefault();if(this.__commends[e])this.__commends[e](c,d,a)}}))};this.isVisible=function(a,b,c){return c?
0<=a.offsetTop-b.scrollTop&&a.offsetTop+a.clientHeight-b.scrollTop<=b.clientHeight?!0:!1:0<a.offsetTop+a.clientHeight-b.scrollTop&&a.offsetTop-b.scrollTop<b.clientHeight?!0:!1};this.css=function(a,b){for(var c in b)a.style[c]=b[c]}});
Z.$package("Z.file",function(c){this.ImageLoader=c.$class({init:function(){this._imageList={}},load:function(b,a,d){var c=this._imageList[b];c||(c={url:b,status:0,cbs:[]},this._imageList[b]=c);if(2===c.status)a.call(d||window,!0,b,c.size);else if(1===c.status)c.cbs.push({cb:a,cxt:d});else{c.cbs.push({cb:a,cxt:d});c.status=1;var a=new Image,f=this;a.onload=function(){var a=f._imageList[this.src];a.status=2;a.size={width:this.width,height:this.height};for(var b=0,d;d=a.cbs[b];b++)d.cb.call(d.context||
window,!0,a.url,a.size);a.cbs=[]};d=function(){var a=f._imageList[this.src];a.status=3;for(var b=0,d;d=a.cbs[b];b++)d.cb.call(d.context||window,!1,a.url);a.cbs=[]};a.onerror=d;a.onabort=d;a.src=b}}})});
Z.$package("Z.message",function(c){var b,a=0,d=function(){if(!b&&(b=document.createElement("div"),!document.createEvent))b.style.cssText="position: absolute; top: -9999em; left: -9999em; width: 0px; height: 0px;",document.body.appendChild(b);return b},e=function(b,c,e){var f,l,j,m;if(2>arguments.length)throw Error("addListener arguments not enough");2===arguments.length&&(e=c,c=b,b=window);if(!b.__listeners)b.__listeners={},b.__listenerId=+new Date+""+a++;j=b.__listeners;m=b.__listenerId;if(j[c])for(l in j[c]){if(f=
j[c][l],f.func===e)return!1}else j[c]=[];l=d();l.addEventListener?(f=function(a){e.apply(window,a.params)},l.addEventListener(m+"-"+c,f,!1)):(f=function(a){var a=window.event,b=a.params.pop();c===a.params[1]&&b===m&&e.apply(window,a.params)},l.attachEvent("onpropertychange",f));f={func:e,wrapFunc:f};j[c].push(f);return!0},f=function(a,b,c){var e,f,j,m;if(2>arguments.length)throw Error("removeListener arguments not enough");2===arguments.length&&(c=b,b=a,a=window);j=a.__listeners;m=a.__listenerId;
if(!j||!j[b])return!1;f=d();for(var p in j[b])if(e=j[b][p],e.func===c)return j[b].slice(p,1),f.removeEventListener?f.removeEventListener(m+"-"+b,e.wrapFunc,!1):f.detachEvent("onpropertychange",e.wrapFunc),!0;return!1};this.on=this.addListener=e;this.off=this.removeListener=f;this.notify=function(a,b,e){var f,l,j,m;1===arguments.length?(b=a,a=window):2===arguments.length&&c.isString(a)&&(e=b,b=a,a=window);c.debug("notify message: "+b);j=a.__listeners;m=a.__listenerId;if(!j||!j[b])return!1;f=d();document.createEvent?
(l=document.createEvent("Events"),l.initEvent(m+"-"+b,!1,!1),l.params=[e,b],f.dispatchEvent(l)):(l=document.createEventObject("onpropertychange"),l.params=[e,b,m],f.fireEvent("onpropertychange",l));return 0!==j[b].length}});
Z.$package("Z.number",function(){this.format=function(c,b){for(var a=c.toString().split("."),d=b?b.split("."):[""],e="",f=a[0],g=d[0],i=f.length-1,k=!1,h=g.length-1;0<=h;h--)switch(g.substr(h,1)){case "#":0<=i&&(e=f.substr(i--,1)+e);break;case "0":e=0<=i?f.substr(i--,1)+e:"0"+e;break;case ",":k=!0,e=","+e}if(0<=i)if(k)for(g=f.length;0<=i;i--)e=f.substr(i,1)+e,0<i&&0==(g-i)%3&&(e=","+e);else e=f.substr(0,i+1)+e;e+=".";f=1<a.length?a[1]:"";g=1<d.length?d[1]:"";for(h=i=0;h<g.length;h++)switch(g.substr(h,
1)){case "#":i<f.length&&(e+=f.substr(i++,1));break;case "0":e=i<f.length?e+f.substr(i++,1):e+"0"}return e.replace(/^,+/,"").replace(/\.$/,"")};this.getMaxMin=function(c){var b=0,a=0,d=c.length;if(0<d)for(var a=c[0],e=0;e<d;e++)c[e]>b?b=c[e]:c[e]<a&&(a=c[e]);return{max:b,min:a}};this.random=function(c,b){return Math.floor(Math.random()*(b-c+1)+c)}});
Z.$package("Z.storage",function(c){var b=c.$class({name:"Storage"},{init:function(a){this._storage=a},isSupport:function(){return null!=this._storage},set:function(a,b){return this.isSupport()?(c.isString(b)||(b=JSON.stringify(b)),this._storage.setItem(a,b),!0):!1},get:function(a){if(this.isSupport()){a=this._storage.getItem(a);try{a=JSON.parse(a)}catch(b){}return a}return!1},remove:function(a){return this.isSupport()?(this._storage.removeItem(a),!0):!1},clear:function(){return this.isSupport()?(this._storage.clear(),
!0):!1}});this.local=new b(window.localStorage);this.session=new b(window.sessionStorage)});
Z.$package("Z.string",function(){this.toQueryString=function(a){var b=[],c;for(c in a)b.push(encodeURIComponent(""+c)+"="+encodeURIComponent(""+a[c]));return b.join("&")};var c={},b=this.template=function(a,d){var e=!/\W/.test(a)?c[a]=c[a]||b(document.getElementById(a).innerHTML):new Function("obj","var z_tmp=[],print=function(){z_tmp.push.apply(z_tmp,arguments);};with(obj){z_tmp.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("z_tmp.push('").split("\r").join("\\'")+
"');}return z_tmp.join('');");return d?e(d):e};this.format=function(a,b,c){if(0==arguments.length)return null;for(var a=arguments[0],f=1;f<arguments.length;f++)a=a.replace(RegExp("\\{"+(f-1)+"\\}","gm"),arguments[f]);return a}});Z.$package("Z.ui",function(c){this.ImageViewer=c.$class({init:function(b){var a;b.element?this._el=b.element:(a=this._el=document.createElement("div"),a.setAttribute("class","image-viewer"),(b.parent||document.body).appendChild(a))},show:function(){},hide:function(){}})});
Z.$package("Z.ui",["Z.util"],function(c){this.ScrollAction=c.define("class",{init:function(b){this._id="scroll_action_"+(b.id||b.element.getAttribute("id"));this._el=b.element;this._step=b.step||50;this._animationDuration=b.animationDuration||10;this._scrollEventDelay=b.scrollEventDelay||200;this._onScrollToBottom=b.onScrollToBottom;this._onScrollToTop=b.onScrollToTop;this._onAnimationStart=b.onAnimationStart;this._onAnimationEnd=b.onAnimationEnd;var a=this;this._el.addEventListener("scroll",function(){c.util.delay(a._id+
"_scroll",a._scrollEventDelay+a._animationDuration,function(){a._noScollEvent?a._noScollEvent=!1:a.isTop()&&a._onScrollToTop?a._onScrollToTop():a.isBottom()&&a._onScrollToBottom&&a._onScrollToBottom()})},!1)},getScrollTop:function(){return this._el.scrollTop},isTop:function(){return 0===this._el.scrollTop},isBottom:function(){return this._el.scrollTop===this._el.scrollHeight-this._el.clientHeight},setAnimation:function(b,a){if(b)this._step=b;if(a)this._animationDuration=a},scrollTo:function(b,a,d){var e=
this;c.util.clearLoop(this._id);var f=this._el.scrollHeight-this._el.clientHeight;c.isString(b)&&("top"===b&&(b=0),"bottom"===b&&(b=f));0>b&&(b=0);b>f&&(b=f);if(b===this._el.scrollTop)return!1;this._noScollEvent=d;if(a){var g=e._el.scrollTop,i=b,k=0<i-g?1:-1,h=!1;c.util.loop(this._id,this._animationDuration,function(){h||(h=!0,e._onAnimationStart&&e._onAnimationStart());g+=k*e._step;var a=!1;if(0<k&&g>i||0>k&&g<i)g=i,a=!0,c.util.clearLoop(e._id);e._el.scrollTop=g;a&&e._onAnimationEnd&&e._onAnimationEnd()})}else this._el.scrollTop=
b;return!0}})});
Z.$package("Z.util",["Z.message"],function(c){this.Beater=c.$class({name:"Beater",statics:{DEFAULT_INTERVAL:50,DEFAULT_MAX_INTERVAL:6E4}},{init:function(b){b=b||{};this._triggers={};this._beaters={};this._isStart=!1;this._autoStart="autoStart"in b?b.autoStart:!0;this._interval=b.interval||this.$static.DEFAULT_INTERVAL;this._maxInterval=b.maxInterval||this.$static.DEFAULT_MAX_INTERVAL},checkBeater:function(){var b=0,a;for(a in this._beaters)b+=this._beaters[a];return!!b},add:function(b,a,d){if(a%this._interval)a=
Math.round(a/this._interval)*this._interval;else if(a<this._interval)a=this._interval;else if(a>this._maxInterval)a=this._maxInterval;if(this._triggers[b])throw Error("beater is exist");this._beaters[a]=this._beaters[a]||0;this._triggers[b]={time:a,func:d};c.message.on(this,"Beater-"+a,d);this._beaters[a]++;!this._isStart&&this._autoStart&&this.start();return!0},remove:function(b){var a=this._triggers[b];if(!a)return!1;var d="Beater-"+a.time;this._beaters[a.time]--;this._triggers[b]=null;delete this._triggers[b];
c.message.off(this,d,a.func);this.checkBeater()||this.stop();return!0},start:function(){if(this._isStart)return!1;var b=this,a=0,d=this._interval;this._timer=setInterval(function(){a+=d;a>=b._maxInterval&&(a=0);var e,f;for(f in b._beaters)b._beaters[f]&&(e=Number(f),a%e||c.message.notify(b,"Beater-"+e,{time:e}))},d);return this._isStart=!0},stop:function(){if(!this._isStart)return!1;clearInterval(this._timer);this._timer=0;this._isStart=!1;return!0}})});
Z.$package("Z.util",["Z.message","Z.array"],function(c){this.Collection=new c.$class({name:"Collection"},{init:function(b){function a(){d.setModify()}b=b||{};this._keyName=b.keyName||"id";this._arr=[];this._map={};this._modifyTime=0;var d=this;c.message.on(this,"add",a);c.message.on(this,"remove",a);c.message.on(this,"clear",a);c.message.on(this,"update",a)},setModify:function(){this._modifyTime=+new Date},getModify:function(){return this._modifyTime},getByKey:function(b){return this.get(b)},getByIndex:function(b){return this.index(b)},
getIndexByKey:function(b,a){a=a||this._keyName;if(this._map[b])for(var c in this._arr)if(this._arr[c][a]==b)return c;return null},getKeyByIndex:function(b,a){var a=a||this._keyName,c=this.getByIndex(b);return c?c[a]:null},get:function(b){return this._map[b]},index:function(b){return this._arr[b]},getRange:function(b,a){return this._arr.slice(b,b+a)},filter:function(b,a){return c.array.filter(this._arr,b,a)},add:function(b,a,d){if(this._map[b[this._keyName]])return!1;this._map[b[this._keyName]]=b;
c.isUndefined(a)?(a=this._arr.length,this._arr.push(b)):this._arr.splice(a,0,b);d||c.message.notify(this,"add",{items:[b],index:a});return b},addRange:function(b,a,d){var e=[],f,g=this._keyName,i;for(i in b)f=b[i],this._map[f[g]]||(e.push(f),this._map[f[g]]=f);if(!e.length)return!1;c.isUndefined(a)?(a=this._arr.length,this._arr=this._arr.concat(e)):(b=[a,0].concat(e),Array.prototype.splice.apply(this._arr,b));d||c.message.notify(this,"add",{items:e,index:a});return e},removeByKey:function(b,a){var d=
this._map[b];if(d){var e=this.getIndexByKey(b);this._arr.splice(e,1);delete this._map[b];a||c.message.notify(this,"remove",{items:[d],index:e,key:b});return d}return!1},removeByIndex:function(b,a){var d=this._arr[b];return d?(this._arr.splice(b,1),delete this._map[d[this._keyName]],a||c.message.notify(this,"remove",{items:[d],index:b,key:d[this._keyName]}),d):!1},remove:function(b){return this.removeByKey(b)},removeRange:function(b,a){var d=[],e,f=this._keyName,g;for(g in b)e=b[g],this.removeByKey(e[f],
!0)&&d.push(e);if(!d.length)return!1;a||c.message.notify(this,"remove",{items:d});return d},update:function(b,a){var d=this.get(b.id);return d?(c.merge(d,b),a||c.message.notify(this,"update",{items:[d]}),d):!1},updateRange:function(b){var a=[],d,e;for(e in b)(d=this.update(b[e],!0))&&a.push(d);a.length&&c.message.notify(this,"update",{items:[a]});return!1},length:function(){return this._arr.length},clear:function(b){var a=this._arr;this._arr=[];this._map={};b||c.message.notify(this,"clear",{items:a})},
getFirst:function(){return this.index(0)},getLast:function(){return this.index(this.length()-1)},getAll:function(){return this.getRange(0,this.length())},each:function(b,a){for(var a=a||this,c=0,e;e=this._arr[c];c++)b.call(a,e,c)},exist:function(b){return!!this.get(b)}})});
Z.$package("Z.util",function(c){this.DependentQueue=new c.$class({name:"DependentQueue",statics:{STATUS_INIT:1,STATUS_RUNNING:2,STATUS_PAUSE:3,STATUS_STOP:4}},{init:function(b){b=b||{};this._onFinish=b.onFinish;this._onPause=b.onPause;this._onStop=b.onStop;this._currentIndex=-1;this._items=[];this._status=this.$static.STATUS_INIT},add:function(b){if(this.isRunning())return!1;this._items.push(b);return!0},isRunning:function(){return this._status===this.$static.STATUS_RUNNING},run:function(){if(this.isRunning()||
0>=this._items.length||this._currentIndex>=this._items.length-1)return!1;this._status=this.$static.STATUS_RUNNING;this.next()},reRun:function(){this._currentIndex--;this.next()},next:function(){this._currentIndex++;var b=this._items[this._currentIndex];b?b.exec(this,b):this._onFinish&&this._onFinish(this)},pause:function(){this._status=this.$static.STATUS_PAUSE;this._onPause&&this._onPause(this,this._items[this._currentIndex])},stop:function(){this._status=this.$static.STATUS_STOP;this._onStop&&this._onStop(this,
this._items[this._currentIndex])}})});
Z.$package("Z.util",["Z.message","Z.string","Z.util"],function(c){this.HttpRequest=new c.$class({init:function(b){this._require=b.require;this._requestCollection=new c.util.Collection({keyName:"id"})},require:function(b,a,d){var e=c.string.toQueryString(a.data),f;f=-1==b.indexOf("?")?b+"?"+e:b+"&"+e;var d=d||{},g=a.onSuccess,i=a.onError,k=a.onTimeout;if(e=this._requestCollection.get(f)){if("loading"===e.status)return!1;if(d.cacheTime&&e.responseTime-e.requireTime<d.cacheTime)return b=a.context||window,
g&&g.call(b,e.response),!0;this._requestCollection.remove(f)}var h={id:f,param:a,requireTime:+new Date,status:"loading"};this._requestCollection.add(h);a.onSuccess=function(b){d.cacheTime?(h.responseTime=+new Date,h.status="loaded",h.response=b):this._requestCollection.remove(f);var c=a.context||window;g&&g.call(c,b)};a.onError=function(b){this._requestCollection.remove(f);var c=a.context||window;i&&i.call(c,b)};a.onTimeout=function(b){this._requestCollection.remove(f);var c=a.context||window;k&&
k.call(c,b)};this._require(b,a)}})});Z.$package("Z.util",function(){this.debounce=function(c,b,a){var d;return function(){if(!d||+new Date-d>c)a?b():setTimeout(b,c),d=+new Date}}});
Z.$package("Z.util",function(){var c={};this.delay=function(b,a,d,e){var f=arguments,g=0;1===f.length?(d=b,a=0,b=null):2===f.length&&(d=a,a=b,b=null);a=a||0;b&&a?(b in c&&(window.clearTimeout(c[b]),g=1),f=window.setTimeout(function(){c[b]=0;delete c[b];d.apply(e||window,[b])},a),c[b]=f):e?window.setTimeout(function(){d.apply(e||window)},a):window.setTimeout(d,a);return g};this.clearDelay=function(b){return b in c?(window.clearTimeout(c[b]),c[b]=0,delete c[b],0):2}});
Z.$package("Z.util",function(c){var b=Object.prototype.hasOwnProperty;this.sizeof=function(a){if(c.isArray(a))return a.length;var d,e=0;for(d in a)b.call(a,d)&&e++;return e}});
Z.$package("Z.util",function(){var c={};this.loop=function(b,a,d,e){var f=0;2==arguments.length&&(d=a,a=b);a=a||0;if(b&&a){b in c&&(window.clearInterval(c[b]),f=1);var g=window.setInterval(function(){d.apply(e||window,[b])},a);c[b]=g}else setInterval(d,a);return f};this.clearLoop=function(b){return b in c?(window.clearInterval(c[b]),c[b]=0,delete c[b],0):2}});
Z.$package("Z.util",function(c){this.timeTaken=function(b){var a=">>>",d,e;2===arguments.length?"function"===typeof arguments[1]?e=arguments[1]:a='"'+arguments[1]+'"':3===arguments.length&&(d=arguments[1],e=arguments[2]);c.debug(a+" time test start.");d&&d();d=+new Date;b();d=+new Date-d;e&&e(d);c.debug(a+" time test end. time taken: "+d)}});
